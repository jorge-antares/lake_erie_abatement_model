# Nginx HTTP Auth
[nginx-http-auth]
enabled = true
port = http,https
logpath = /var/log/nginx/*error.log
maxretry = 3
bantime = 3600

# Nginx Limit Request - Too many requests
[nginx-limit-req]
enabled = true
port = http,https
logpath = /var/log/nginx/*error.log
maxretry = 10
findtime = 60
bantime = 1800

# Nginx Botsearch - Block bots searching for vulnerabilities
[nginx-botsearch]
enabled = true
port = http,https
logpath = /var/log/nginx/*access.log
maxretry = 5
findtime = 600
bantime = 7200

# Nginx Bad Requests - Block malformed requests
[nginx-badbots]
enabled = true
port = http,https
logpath = /var/log/nginx/*access.log
maxretry = 3
findtime = 600
bantime = 86400

# Block 404 attacks
[nginx-noscript]
enabled = true
port = http,https
logpath = /var/log/nginx/*access.log
maxretry = 6
findtime = 300
bantime = 3600

# Block script injection attempts
[nginx-noproxy]
enabled = true
port = http,https
logpath = /var/log/nginx/*access.log
maxretry = 2
findtime = 300
bantime = 86400

# Custom jail for excessive POST requests (optimization endpoint protection)
[nginx-post-limit]
enabled = true
port = http,https
filter = nginx-post-limit
logpath = /var/log/nginx/*access.log
maxretry = 10
findtime = 60
bantime = 3600

# Block repeated 403 errors
[nginx-403]
enabled = true
port = http,https
logpath = /var/log/nginx/*access.log
maxretry = 5
findtime = 600
bantime = 3600

# Block repeated 400 errors (bad requests)
[nginx-400]
enabled = true
port = http,https
logpath = /var/log/nginx/*access.log
maxretry = 5
findtime = 300
bantime = 3600

# DDoS protection - connection flood
[nginx-conn-limit]
enabled = true
port = http,https
logpath = /var/log/nginx/*error.log
maxretry = 5
findtime = 10
bantime = 600
