{% extends "base.html" %}

{% block title %}Mathematical Model Documentation{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-center mb-5">Lake Erie Abatement Optimization Model</h1>
    
    <div class="row">
        <div class="col-lg-10 mx-auto">
            
            <h2>Model Overview</h2>
            <p>The Lake Erie Abatement Optimization model addresses phosphorus pollution through two complementary approaches:</p>
            
            <h3>1. Target-Based Optimization</h3>
            <div class="card mb-4">
                <div class="card-body">
                    <h5>Objective Function:</h5>
                    $$\min f(\mathbf{x}, \mathbf{w}) = \mathbf{x}^T \mathbf{A} \mathbf{x} + \mathbf{b}^T \mathbf{w}$$
                    
                    <h5>Subject to:</h5>
                    $$\mathbf{S} \mathbf{x} + \mathbf{W} \mathbf{w} \geq \mathbf{z}_{target}$$
                    $$\mathbf{x} \geq 0$$
                    $$\mathbf{w} \in \{0,1\}^{n}$$
                    
                    <h5>Where:</h5>
                    $$\mathbf{W} = \mathbf{S} \times \mathbf{L} \times \mathbf{F}$$
                </div>
            </div>
            
            <h3>2. Budget-Constrained Optimization</h3>
            <div class="card mb-4">
                <div class="card-body">
                    <h5>Objective Function:</h5>
                    $$\max g(\mathbf{x}, \mathbf{w}) = \mathbf{c}^T (\mathbf{S} \mathbf{x} + \mathbf{W} \mathbf{w})$$
                    
                    <h5>Subject to:</h5>
                    $$\mathbf{x}^T \mathbf{A} \mathbf{x} + \mathbf{b}^T \mathbf{w} \leq B$$
                    $$\mathbf{x} \geq 0$$
                    $$\mathbf{w} \in \{0,1\}^{n}$$
                </div>
            </div>
            
            <h2>Variable Definitions</h2>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Variable</th>
                            <th>Description</th>
                            <th>Units</th>
                            <th>Dimension</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>$\mathbf{x}$</td>
                            <td>Agricultural abatement by region</td>
                            <td>tonne/year</td>
                            <td>$\mathbb{R}^{m}_+$</td>
                        </tr>
                        <tr>
                            <td>$\mathbf{w}$</td>
                            <td>Binary variables for WWTP investments</td>
                            <td>unitless</td>
                            <td>$\{0,1\}^{n}$</td>
                        </tr>
                        <tr>
                            <td>$\mathbf{A}$</td>
                            <td>Agricultural cost matrix (quadratic)</td>
                            <td>Million CAD/(tonne<sup>2</sup> year)</td>
                            <td>$\mathbb{R}^{m \times m}$</td>
                        </tr>
                        <tr>
                            <td>$\mathbf{b}$</td>
                            <td>WWTP maintenance costs</td>
                            <td>Million CAD/(thousand m<sup>3</sup> year)</td>
                            <td>$\mathbb{R}^{n}$</td>
                        </tr>
                        <tr>
                            <td>$\mathbf{S}$</td>
                            <td>Steady state mass balance matrix</td>
                            <td>ppb/tonne</td>
                            <td>$\mathbb{R}^{m \times m}$</td>
                        </tr>
                        <tr>
                            <td>$\mathbf{L}$</td>
                            <td>Matrix that links WWTPs to regions</td>
                            <td>unitless</td>
                            <td>$\mathbb{R}^{m \times n}$</td>
                        </tr>
                        <tr>
                            <td>$\mathbf{F}$</td>
                            <td>Diagonal matrix of WWTP effective abatement</td>
                            <td>tonne/year</td>
                            <td>$\mathbb{R}^{n \times n}$</td>
                        </tr>
                        <tr>
                            <td>$\mathbf{c}$</td>
                            <td>Relative weight vector for regions</td>
                            <td>unitless</td>
                            <td>$\mathbb{R}^{m}$</td>
                    </tbody>
                </table>
            </div>
            
            <h2>Lake Erie Regions</h2>
            <p>The model considers six distinct regions of the Lake Erie system:</p>
            <ol>
                <li><strong>SCR</strong> - St. Clair River</li>
                <li><strong>LSC</strong> - Lake St. Clair</li>
                <li><strong>DR</strong> - Detroit River</li>
                <li><strong>WB</strong> - Western Basin</li>
                <li><strong>CB</strong> - Central Basin</li>
                <li><strong>EB</strong> - Eastern Basin</li>
            </ol>
            
            <div class="text-center mt-4">
                <a href="/optimize" class="btn btn-primary btn-lg">
                    <i class="bi bi-calculator"></i> Run Optimization
                </a>
                <a href="/" class="btn btn-secondary btn-lg ms-3">
                    <i class="bi bi-house"></i> Home
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}